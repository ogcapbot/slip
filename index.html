<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OG Capper Bets - Live Ticket Generator</title>
  <style>
    body {
      font-family: monospace;
      background: #f4f4f4;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    input, button {
      padding: 10px;
      margin: 5px;
      font-size: 16px;
    }
    .ticket {
      background: white;
      border: 2px solid #000;
      padding: 16px;
      width: 375px;
      margin-top: 20px;
    }
    .logo {
      width: 180px;
    }
    .official {
      text-align: center;
      font-weight: bold;
      color: red;
      margin: 8px 0;
    }
    .type-label {
      font-weight: bold;
      border: 1px solid black;
      padding: 4px;
      text-align: center;
      margin: 12px 0;
    }
    .hype {
      font-size: 11px;
      text-align: center;
      font-style: italic;
    }
    .details {
      font-size: 13px;
      line-height: 1.5;
      margin-top: 10px;
    }
    .ticket-id {
      font-size: 11px;
      margin: 10px 0;
    }
    .footer {
      font-size: 9px;
      text-align: center;
      white-space: pre-line;
      margin-top: 20px;
    }
    .barcode-footer {
      display: flex;
      justify-content: space-between;
      margin-top: 10px;
    }
    .barcode-footer img {
      width: 80px;
    }
  </style>
</head>
<body>
  <h2>OG Capper Bets - Ticket Generator</h2>
  <input type="text" id="wagerInput" placeholder="Example: yankees ml 1.5u">
  <button onclick="generateSlip()">Create Ticket</button>

  <div id="output"></div>

  <script>
    async function generateSlip() {
      const input = document.getElementById('wagerInput').value;
      const output = document.getElementById('output');
      output.innerHTML = 'Loading...';

      try {
        const response = await fetch(`https://api.the-odds-api.com/v4/sports/baseball_mlb/odds/?regions=us&markets=h2h&apiKey=5b3cb0e7293b7d6217e6e99fa768fd0b`);
        const games = await response.json();

        const game = games.find(g => input.toLowerCase().includes(g.home_team.toLowerCase()) || input.toLowerCase().includes(g.away_team.toLowerCase()));

        if (!game) {
          output.innerHTML = 'Game not found. Please check your input or try a different team.';
          return;
        }

        const odds = game.bookmakers[0].markets[0].outcomes.find(o => input.toLowerCase().includes(o.name.toLowerCase()));
        const now = new Date();
        const since1981 = Math.floor((now.getTime() - new Date('1981-07-25T12:00:00Z').getTime()) / 1000);
        const ticketId = `${since1981}-${(now.getMonth()+1).toString().padStart(2, '0')}${now.getFullYear().toString().slice(-2)}`;

        const amount = (parseFloat(input.match(/\d+(\.\d+)?(?=u)/)?.[0] || '1') * 100).toFixed(2);

        const html = `
        <div class="ticket">
          <img src="mainLogo.jpeg" alt="OG Capper Logo" class="logo">
          <div class="official">OFFICIAL PICK</div>
          <div class="type-label">STRAIGHT BET</div>
          <div class="hype">"${now.toLocaleDateString()} - $${amount} BANGER - MLB - Starts @ ${new Date(game.commence_time).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})} EST"</div>
          <div class="details">
            <strong>Event:</strong> ${game.home_team} vs. ${game.away_team}<br>
            <strong>Market:</strong> Moneyline<br>
            <strong>Pick:</strong> ${odds.name}<br>
            <strong>Units:</strong> ${amount/100}u<br>
            <strong>Odds:</strong> ${odds.price}<br>
            <strong>Time:</strong> ${new Date(game.commence_time).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})} EST
          </div>
          <div class="ticket-id">Ticket #: ${ticketId}</div>
          <div class="barcode-footer">
            <img src="HO1981MU0725RU - Barcode2.png" alt="barcode">
            <img src="OG Capper Bet - QR Code.png" alt="qr code">
          </div>
          <div class="footer">
════════════════⚠️ STRICT CONFIDENTIALITY NOTICE ⚠️════════════════  
All OG Capper Bets Content—Public, Free, or Paid—is for your eyes only. Leaking, Sharing, Copying, Forwarding 
       or Using ANY Content is Strictly Prohibited. Violation = Immediate Termination. No Refund. No Appeal.  
                    Lifetime Ban. Full Terms, Rules and Disclaimers are available @ ogcapperbets.com.
          </div>
        </div>`;

        output.innerHTML = html;
      } catch (err) {
        output.innerHTML = `Error: ${err.message}`;
      }
    }
  </script>
</body>
</html>
