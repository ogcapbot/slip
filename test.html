<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Stats PNG Generator with Aspect Ratio Fix</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; background: #eee; }
  #generateBtn { padding: 10px 20px; font-size: 16px; cursor: pointer; margin-bottom: 20px; }
  #outputImage { border: 1px solid #ccc; max-width: 100%; }
</style>
</head>
<body>

<h1>Stats PNG Generator Test (Aspect Ratio Fixed)</h1>
<button id="generateBtn">Generate PNG</button>
<br />
<img id="outputImage" alt="Generated Stats PNG" />

<script>
const templateUrl = 'https://capper.ogcapperbets.com/admin/images/blankWatermark.png';

const statusColors = {
  Win: '#28a745',
  Lost: '#dc3545',
  Push: '#007bff',
  Pending: '#6c757d'
};

const statusEmojis = {
  Win: '‚úÖ',
  Lost: '‚ùå',
  Push: 'üü¶',
  Pending: '‚öôÔ∏è'
};

// Sample picks data ‚Äî replace with your real data source
const picks = [
  { teamSelected: 'Team A', wagerType: 'Spread', gameWinLossDraw: 'Win', unit: '+3' },
  { teamSelected: 'Team B', wagerType: 'Moneyline', gameWinLossDraw: 'Lost', unit: '-5' },
  { teamSelected: 'Team C', wagerType: 'Totals', gameWinLossDraw: 'Push', unit: 'o42.5' },
  { teamSelected: 'Team D', wagerType: 'Spread', gameWinLossDraw: 'Pending', unit: '+7' },
  // Add more picks to test scrolling or multi-page later
];

const generateBtn = document.getElementById('generateBtn');
const outputImage = document.getElementById('outputImage');

generateBtn.addEventListener('click', () => {
  const canvas = document.createElement('canvas');
  const ctx = canvas.getContext('2d');

  const background = new Image();
  background.crossOrigin = 'anonymous';
  background.src = templateUrl;

  background.onload = () => {
    // Resize canvas to match the natural size of the watermark image (preserves aspect ratio)
    canvas.width = background.naturalWidth;
    canvas.height = background.naturalHeight;

    // Draw the watermark background at natural size (no stretch)
    ctx.drawImage(background, 0, 0, canvas.width, canvas.height);

    // Header text styling
    ctx.fillStyle = '#222';
    ctx.font = 'bold 36px Arial';
    ctx.textAlign = 'center';
    ctx.fillText('Official Picks Stats Report', canvas.width / 2, 140);

    // Generation datetime
    ctx.font = '18px Arial';
    ctx.fillStyle = '#555';
    const nowStr = new Date().toLocaleString('en-US', { timeZone: 'America/New_York' });
    ctx.fillText(`Generated: ${nowStr}`, canvas.width / 2, 180);

    // Draw picks list starting below header
    ctx.textAlign = 'left';
    ctx.font = '20px Arial';

    let y = 230;
    const leftMargin = 100;

    picks.forEach(pick => {
      // Draw colored circle for status with emoji
      const color = statusColors[pick.gameWinLossDraw] || '#000';
      ctx.fillStyle = color;
      ctx.beginPath();
      ctx.arc(leftMargin - 40, y - 12, 16, 0, 2 * Math.PI);
      ctx.fill();

      ctx.fillStyle = '#fff';
      ctx.font = 'bold 18px Arial';
      ctx.textAlign = 'center';
      ctx.fillText(statusEmojis[pick.gameWinLossDraw] || '‚ùì', leftMargin - 40, y + 6);

      ctx.font = '20px Arial';
      ctx.fillStyle = '#222';
      ctx.textAlign = 'left';

      ctx.fillText(`Team: ${pick.teamSelected}`, leftMargin, y);
      ctx.fillText(`Wager: ${pick.wagerType}`, leftMargin, y + 28);
      ctx.fillText(`Unit: ${pick.unit}`, leftMargin, y + 56);
      ctx.fillText(`Status: ${pick.gameWinLossDraw}`, leftMargin, y + 84);

      y += 120; // spacing between picks
    });

    // Export canvas to PNG data URL and show in image element
    const dataURL = canvas.toDataURL('image/png');
    outputImage.src = dataURL;

    // Optional: automatically download the PNG
    /*
    const a = document.createElement('a');
    a.href = dataURL;
    a.download = 'official_picks_stats.png';
    a.click();
    */
  };
});
</script>

</body>
</html>
