<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>OG Capper Bets - Official Pick Image Creator v7.25</title>

<link href="https://fonts.googleapis.com/css2?family=Oswald&display=swap" rel="stylesheet">

  <style>
    body {
  font-family: 'Oswald', sans-serif;
  background: #f9f9f9;
  margin: 0;
  padding: 0;
  display: flex;
  justify-content: center;
}

    .container {
      width: 100%;
      max-width: 400px;
      padding: 20px;
    }

   input[type="number"],
input[type="text"],
select,
textarea {
  width: 100%;
  max-width: 400px;
  box-sizing: border-box;
  margin: 0 auto 12px;
  display: block;
  padding: 12px;
  font-size: 16px;
  border-radius: 6px;
  border: 1px solid #ccc;
}




    button {
  width: 100%;
  max-width: 400px;
  box-sizing: border-box;
  margin: 0 auto 12px;
  display: block;
  padding: 12px;
  font-size: 16px;
  background-color: #2a9fd6;
  color: white;
  border: none;
  border-radius: 6px;
  cursor: pointer;
}

    button:hover {
      background-color: #2179a5;
    }

    .hidden {
      display: none;
    }

    .error {
      color: red;
      font-size: 14px;
      margin-top: 10px;
    }

    #loader {
      border: 6px solid #f3f3f3;
      border-top: 6px solid #2a9fd6;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 1s linear infinite;
      margin: 20px auto;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    #confirmOutput {
      white-space: pre-wrap;
      font-family: monospace;
      background: #fff;
      border: 1px solid #ccc;
      padding: 15px;
      border-radius: 6px;
      margin-top: 10px;
      resize: none;
      overflow: hidden;
      min-height: 200px;
      height: auto;
    }

    #resetWrapper {
  position: relative;
  width: 100%;
  max-width: 400px;
  margin: 0 auto;
  height: 0;
}

#resetBtn {
  position: absolute;
  top: -35px; /* Move it higher above inputs */
  right: 0;
  font-size: 14px;
  padding: 4px 12px;
  background-color: #2a9fd6;
  color: white;
  border: none;
  border-radius: 4px;
  cursor: pointer;
  height: auto;
  width: auto;
  white-space: nowrap;
}







    #copyBtn {
      margin-bottom: 10px;
    }

    #loginNotice {
      margin-bottom: 20px;
      font-weight: bold;
    }

    #inputLabel {
      color: #666;
      font-size: 14px;
      margin-bottom: 5px;
    }

    #gameSuggestion {
  border: 1px solid #ccc;
  border-radius: 6px;
  padding: 15px;
  background: #fff;
  margin-bottom: 20px;
  width: 100%;
  max-width: 400px;
  margin-left: auto;
  margin-right: auto;
  box-sizing: border-box;
}



    #gameSuggestion p {
      margin: 6px 0;
    }

    #gameSuggestion strong {
      display: block;
      margin-bottom: 10px;
      font-size: 16px;
    }

    #gameTable,
    #sportDropdown {
      display: none;
    }
#sports-screen {
  position: relative;
  overflow: hidden;
}

  


#imageLoader {
  border: 6px solid #f3f3f3;
  border-top: 6px solid #2a9fd6;
  border-radius: 50%;
  width: 50px;
  height: 50px;
  animation: spin 1s linear infinite;
  margin: 0 auto 10px;
}
#imageLoaderText {
  font-size: 16px;
  font-weight: bold;
  color: #2a9fd6;
  animation: blink 1.5s infinite;
}
@keyframes blink {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.2; }
}

/* NEW Hype Phrase Step Styling */
#hypePhraseStep {
  margin-top: 20px;
  font-family: monospace;
  background: #fff;
  border: 1px solid #ccc;
  padding: 15px;
  border-radius: 6px;
  max-height: 300px;
  overflow-y: auto;
}

.hypeOutputBlock {
  border: 1px solid #2a9fd6;
  padding: 10px;
  margin-bottom: 10px;
  cursor: pointer;
  border-radius: 6px;
  user-select: none;
  background-color: #f0faff;
}
.hypeOutputBlock:hover {
  background-color: #d0eaff;
}

  </style>
</head>
<body>


  <div class="container" id="access-screen">
  
  <div id="globalHeader" style="text-align: center; padding: 20px 0 10px;">
    <h3 style="margin: 0;">OG Capper Bets – Official Pick Image Creator v7.25</h3>
    <h5 style="margin: 0; color: red;">Official Use Only</h5>
  </div>
        
    <label style="color: #666; font-size: 14px; margin-bottom: 10px; display: block;">Enter Access Code</label>
<input
  type="text"
  id="accessCode"
  placeholder="Enter Code Here"
  pattern="[0-9]*"
  inputmode="numeric"
  maxlength="10"
  style="width: 100%; max-width: 400px; box-sizing: border-box; display: block; margin: 0 auto 12px; padding: 12px; font-size: 16px; border-radius: 6px; border: 1px solid #ccc;"
/>
    <button id="accessBtn" onclick="validateAccess()">Submit</button>
    <div class="error" id="error"></div>
  </div>


  <div class="container hidden" id="sports-screen">
    <div id="loader"></div>
    <div id="loadingMsg" style="text-align:center; font-weight:bold;">Loading Games...</div>

    <div id="loggedInInfo" class="hidden">
  
  <div id="globalHeader" style="text-align: center; padding: 20px 0 10px;">
    <h3 style="margin: 0;">OG Capper Bets – Official Pick Image Creator v7.25</h3>
    <h5 style="margin: 0; color: red;">Official Use Only</h5>
    <h5 id="loginNotice" style="margin: 0; color: gray;"></h5>
  </div>
    
    

  <div id="resetWrapper">
  <button id="resetBtn" onclick="resetSearch()">Reset</button>
</div>


  <div id="gameSuggestion" class="hidden"></div>


  </div>
      <div id="inputLabel">Enter Team Name: (e.g. 'Chicago Cubs' or 'Cubs')</div>
      <input type="text" id="teamSearch" placeholder="Must be at least 3 Characters" />
      <button id="searchBtn" onclick="searchGames()">Submit</button>
      <div class="error" id="searchError"></div>

      

      <div id="customInputSection" class="hidden">
  <label for="wagerType" style="color: #666; font-size: 14px; margin-bottom: 5px; display: block;">
    Enter Wager Type (e.g. 'ML' or 'F5' or 'TT OVER 5')
  </label>
  <input type="text" id="wagerType" />
  <button onclick="submitWagerType()">Submit</button>
  <div class="error" id="wagerError"></div>
</div>

    <!-- ✅ Unit Dropdown moved OUTSIDE of #customInputSection -->
<div id="unitDropdownSection" class="hidden">
  <label for="unitDropdown" style="color:#666;font-size:14px;margin-bottom:5px;display:block;">
    Select Unit(s):
  </label>
  <select id="unitDropdown"></select>
  <div class="error" id="unitDropdownError"></div>
</div>




        <div id="notesChoiceSection" class="hidden">
  <label style="color: #666; font-size: 14px; margin-bottom: 10px; display: block;">
    Do You Want to Include any Comments/Notes?
  </label>
  <button id="yesNoteBtn">Yes, Enter Comment/Note</button>
  <button id="noNoteBtn">No, Proceed to Image Creation</button>
</div>

<!-- Note Entry Section -->
<div id="notesInputSection" class="hidden" style="margin-top: 20px;">
  <div id="notesHeaderRow" style="display: none; justify-content: space-between; align-items: center; margin-bottom: 5px;">
    <label for="notesInput" style="color: #666; font-size: 14px;">
      Enter Your Comment/Note Below:
    </label>
    <div id="charCount" style="color: #666; font-size: 14px;">
      Remaining: 100
    </div>
  </div>

  <textarea 
    id="notesInput" 
    rows="2" 
    maxlength="100" 
    placeholder="Enter Comment/Note Here"
    style="font-family: 'Oswald', Arial, sans-serif; font-size: 14px; width: 100%; box-sizing: border-box;"
  ></textarea>

  <button id="submitNoteBtn" class="hidden">Submit</button>
</div>     

<!-- NEW Hype Phrase Step -->
<div id="hypePhraseStep" class="hidden container">
  <label for="hypeASelect" style="color:#666; font-size:14px; margin-bottom:5px; display:block;">
    Select Hype Phrase Category:
  </label>
  <select id="hypeASelect">
    <option value="">-- Select Category --</option>
  </select>

  <label for="hypeBSelect" style="color:#666; font-size:14px; margin-bottom:5px; display:block; margin-top:15px;">
    Select Specific Phrase:
  </label>
  <select id="hypeBSelect" disabled>
    <option value="">-- Select Phrase --</option>
  </select>

  <div id="hypePhraseOutputs" style="margin-top:20px;">
    <!-- Outputs appear here -->
  </div>
</div>

     <pre id="confirmOutput" class="hidden" style="white-space:pre-wrap; word-wrap:break-word; background:#fff; border:1px solid #ccc; padding:15px; border-radius:6px; margin-top:10px; min-height:200px;"></pre>

    </div> <!-- closes #sports-screen -->
  </div>

  <script>
    const BASE_URL = "https://script.google.com/macros/s/AKfycbzbNo6fcQsDvPSlsaC9y1U3NsO214vuS-7a6EwhtFXi-sH3fHQaJawg6LDehcf4TCepkA/exec";
    let capperInfo = [], allData = {}, currentMatchIndex = 0, matches = [], selectedMatch = null, capperName = "";

    window.onload = async () => {
      try {
        const res = await fetch(BASE_URL + "?action=capperOnly");
        const result = await res.json();
        capperInfo = result.capperInfo;

        document.getElementById("accessCode").disabled = false;
        document.getElementById("accessBtn").disabled = false;
        document.getElementById("accessCode").focus();
      } catch {
        document.getElementById("error").textContent = "Failed to load access codes.";
      }
    };

    function validateAccess() {
      const code = document.getElementById("accessCode").value.trim();
      const match = capperInfo.find(row => row["Access Code"] == code);
      if (code.length < 4 || code.length > 10 || !match) {
        document.getElementById("error").textContent = "Access Code Invalid. Please Enter a Valid Access Code.";
        return;
      }

      capperName = match["Display Name"];
      document.getElementById("access-screen").classList.add("hidden");
      document.getElementById("sports-screen").classList.remove("hidden");

      // Hide all children of sports-screen except loader and loadingMsg
      Array.from(document.querySelectorAll("#sports-screen > *"))
        .forEach(el => {
          if (el.id !== "loader" && el.id !== "loadingMsg") {
            el.style.display = "none";
          }
        });

      loadAllData();
    }

    document.getElementById("accessCode").addEventListener("input", (e) => {
      e.target.value = e.target.value.replace(/\D/g, "");
      if (e.target.value.length > 10) {
        e.target.value = e.target.value.slice(0, 10);
      }
    });

    async function loadAllData() {
      try {
        const res = await fetch(BASE_URL + "?action=data");
        allData = await res.json();
        console.log("Loaded allData:", allData);
        console.log("Units data:", allData.units);
        document.getElementById("loader").style.display = "none";
        document.getElementById("loadingMsg").style.display = "none";

        // Show all other elements again (excluding loader and loadingMsg)
        Array.from(document.querySelectorAll("#sports-screen > *"))
          .forEach(el => {
            if (el.id !== "loader" && el.id !== "loadingMsg") {
              el.style.display = "";
            }
          });
        console.log("Wagers Data:", allData.wagers);

        document.getElementById("loggedInInfo").classList.remove("hidden");
        document.getElementById("teamSearch").focus();
        document.getElementById("loginNotice").textContent = `Logged in as: ${capperName}`;
      } catch {
        alert("Failed to load sports data.");
      }
    }

    // -- Your existing event listeners and functions here unchanged --
    // ... (omitted for brevity but all your original code is intact)

    // -------------------- NEW CODE TO HANDLE HYPE PHRASE STEP --------------------

    // When user clicks No on notes, show hype phrase step instead of generating final output
    document.getElementById("noNoteBtn").addEventListener("click", () => {
      document.getElementById("notesChoiceSection").classList.add("hidden");
      document.getElementById("hypePhraseStep").classList.remove("hidden");
      populateHypeACategories();
    });

    // When user submits notes, show hype phrase step instead of final output
    document.getElementById("submitNoteBtn").addEventListener("click", () => {
      const note = document.getElementById("notesInput").value.trim();
      document.getElementById("notesInputSection").classList.add("hidden");
      document.getElementById("hypePhraseStep").classList.remove("hidden");
      populateHypeACategories();
      window.latestNote = note || "N/A"; // save note for later use
    });

    // Populate first dropdown with unique Column A values
    function populateHypeACategories() {
      const selectA = document.getElementById("hypeASelect");
      selectA.innerHTML = '<option value="">-- Select Category --</option>';

      const categories = new Set();
      (allData.hypePhrases || []).forEach(row => {
        if (row.A && !categories.has(row.A)) {
          categories.add(row.A);
        }
      });

      [...categories].sort().forEach(cat => {
        const option = document.createElement("option");
        option.value = cat;
        option.textContent = cat;
        selectA.appendChild(option);
      });

      // Reset second dropdown and outputs
      const selectB = document.getElementById("hypeBSelect");
      selectB.innerHTML = '<option value="">-- Select Phrase --</option>';
      selectB.disabled = true;

      document.getElementById("hypePhraseOutputs").innerHTML = "";
    }

    // Populate second dropdown based on first dropdown selection
    document.getElementById("hypeASelect").addEventListener("change", function () {
      const selectedCategory = this.value;
      const selectB = document.getElementById("hypeBSelect");
      selectB.innerHTML = '<option value="">-- Select Phrase --</option>';

      if (!selectedCategory) {
        selectB.disabled = true;
        document.getElementById("hypePhraseOutputs").innerHTML = "";
        return;
      }

      const filteredBs = new Set();
      (allData.hypePhrases || []).forEach(row => {
        if (row.A === selectedCategory && row.B) {
          filteredBs.add(row.B);
        }
      });

      [...filteredBs].sort().forEach(bVal => {
        const option = document.createElement("option");
        option.value = bVal;
        option.textContent = bVal;
        selectB.appendChild(option);
      });

      selectB.disabled = false;
      document.getElementById("hypePhraseOutputs").innerHTML = "";
    });

    // Show randomized outputs based on selections from A and B dropdowns
    document.getElementById("hypeBSelect").addEventListener("change", function () {
      const selectedCategory = document.getElementById("hypeASelect").value;
      const selectedPhrase = this.value;
      const outputDiv = document.getElementById("hypePhraseOutputs");

      if (!selectedPhrase) {
        outputDiv.innerHTML = "";
        return;
      }

      const matches = (allData.hypePhrases || []).filter(row => row.A === selectedCategory && row.B === selectedPhrase);

      const shuffled = matches.slice().sort(() => Math.random() - 0.5);

      const unitVal = document.getElementById("unitDropdown")?.value || "[[UNIT]]";

      const gameTime = (() => {
        if (!selectedMatch || !selectedMatch["Commence Time (UTC)"]) return "N/A";
        const dt = new Date(selectedMatch["Commence Time (UTC)"]);
        return dt.toLocaleString("en-US", {timeZone: "America/New_York", hour: "numeric", minute: "2-digit", hour12: true}) + " EST";
      })();

      const sportFromInput = selectedMatch ? (selectedMatch["Sport Name"] || "N/A") : "N/A";

      let html = "";
      shuffled.forEach(row => {
        const sport = row.C || "N/A";
        const phrase = row.D || "";
        const promo = row.E || "";

        const postTitle = `${unitVal} UNITS - ${phrase} - ${sportFromInput} ⚾️ - STARTS @ ${gameTime}`;

        html += `
          <div class="hypeOutputBlock" tabindex="0" role="button" aria-pressed="false" style="border: 1px solid #2a9fd6; padding: 10px; margin-bottom: 10px; cursor: pointer; border-radius: 6px;">
            <div><strong>Related Sport:</strong> ${sport}</div>
            <div><strong>Post Title:</strong> ${postTitle}</div>
            <div><strong>Post Description:</strong> ${promo}</div>
          </div>
        `;
      });

      outputDiv.innerHTML = html;

      Array.from(outputDiv.querySelectorAll(".hypeOutputBlock")).forEach((block, i) => {
        block.onclick = () => {
          const selectedRow = shuffled[i];
          window.selectedHypePostTitle = `${unitVal} UNITS - ${selectedRow.D} - ${sportFromInput} ⚾️ - STARTS @ ${gameTime}`;
          window.selectedHypeRow = selectedRow;
          window.selectedHypeNote = window.latestNote || "N/A";

          document.getElementById("hypePhraseStep").classList.add("hidden");

          // Before proceeding, update the global _cleanedOutput or pass the title to your final output generator
          // Here we'll override your final output function with the updated title, notes
          generateFinalOutput(window.selectedHypeNote, window.selectedHypePostTitle);

          // Show confirmOutput and image creation here (your existing function opens image generator)
        };
        block.onkeydown = (e) => {
          if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            block.click();
          }
        }
      });
    });

    // Update your existing generateFinalOutput to accept optional newTitle parameter and override [[TITLE]]
    // We'll patch your generateFinalOutput function to handle this — minimal change, safe to do here

    const originalGenerateFinalOutput = generateFinalOutput;
    generateFinalOutput = function (notes, newTitle) {
      notes = notes || "N/A";
      // Save the newTitle to global var if provided
      if (newTitle) window.overrideTitle = newTitle;

      // Run original function to produce output text, but with [[TITLE]] replaced by overrideTitle
      let wagerRaw = "";
      const wagerInput = document.getElementById("wagerType");
      const wagerDropdown = document.getElementById("wagerDropdown");

      if (wagerInput) {
        wagerRaw = wagerInput.value.trim();
      } else if (wagerDropdown) {
        wagerRaw = wagerDropdown.value.trim();
      }
      const wager = wagerRaw.toUpperCase();

      const teamSearchEl = document.getElementById("teamSearch");
      const teamSearchInput = window.overrideTeamName || (teamSearchEl ? teamSearchEl.value.trim() : "");
      const dropdown = document.getElementById("unitDropdown");
      const unitInput = dropdown ? dropdown.value.trim() : "";
      const allInputsRaw = `${teamSearchInput} ${wagerRaw} ${unitInput}`;

      let matchedTeam = "";
      const teamSearchLower = teamSearchInput.toLowerCase();

      if (window.overrideTeamName) {
        matchedTeam = window.overrideTeamName;
      } else if (
        selectedMatch &&
        selectedMatch["Home Team"] !== "Unavailable" &&
        selectedMatch["Away Team"] !== "Unavailable"
      ) {
        const home = selectedMatch["Home Team"];
        const away = selectedMatch["Away Team"];
        matchedTeam = [home, away].find(team => team.toLowerCase().includes(teamSearchLower)) || teamSearchInput;
      } else {
        matchedTeam = teamSearchInput;
      }

      let formattedTime = "Unavailable";
      if (selectedMatch && selectedMatch["Commence Time (UTC)"]) {
        const date = new Date(selectedMatch["Commence Time (UTC)"]);
        formattedTime = date.toLocaleString("en-US", {
          timeZone: "America/New_York",
          weekday: "short", month: "short", day: "numeric",
          hour: "numeric", minute: "2-digit", hour12: true
        }) + " ET";
      }

      const nowNY = new Date().toLocaleString("en-US", { timeZone: "America/New_York" });
      const nyDate = new Date(nowNY);
      const estString = `${nyDate.getFullYear()}-${String(nyDate.getMonth() + 1).padStart(2, '0')}-${String(nyDate.getDate()).padStart(2, '0')} ${String(nyDate.getHours()).padStart(2, '0')}:${String(nyDate.getMinutes()).padStart(2, '0')}:${String(nyDate.getSeconds()).padStart(2, '0')}`;

      const secondsSinceEpoch = Math.floor((new Date() - new Date("1981-07-25T12:00:00Z")) / 1000);
      const today = new Date();
      const mmddyy = `${today.getMonth() + 1}${today.getDate()}${today.getFullYear().toString().slice(2)}`;
      const pickId = `${secondsSinceEpoch}-${mmddyy}`;

      let pickDescValue = "Unavailable";

      if (document.getElementById("wagerDropdown") && !window.overrideTeamName) {
        const selectedWager = document.getElementById("wagerDropdown").value;
        const wagerRow = (allData.wagers || []).find(row =>
          row.wager_label_template === selectedWager
        );

        if (wagerRow && wagerRow.pick_desc_template) {
          pickDescValue = wagerRow.pick_desc_template;

          // Replace [[TEAM]] with actual matched team
          pickDescValue = pickDescValue.replace(/\[\[TEAM\]\]/g, matchedTeam);

          // Extract number from wager text if available
          const numberMatch = selectedWager.match(/\d+(\.\d+)?/);
          if (numberMatch) {
            const numericValue = numberMatch[0];
            pickDescValue = pickDescValue
              .replace(/\[\[NUM\]\]/g, numericValue)
              .replace(/\[\[NUMBER\]\]/g, numericValue);
          }
        }
      }

      // Use overrideTitle if set, else default [[TITLE]]
      const titleToUse = window.overrideTitle || "[[TITLE]]";

      const output = [
        "═══════════════════════",
        "######## OFFICIAL PICK",
        "═══════════════════════",
        `Wager Type: STRAIGHT WAGER`,
        `Official Pick: ${matchedTeam}`,
        `Official Type: ${wager}`,
        `Official Wager: ${unitInput} Unit(s)`,
        `To Win: ${pickDescValue}`,
        "",
        "═══════════════════════",
        "######## GAME DETAILS",
        "═══════════════════════",
        `Sport: ${selectedMatch["League (Group)"]?.toUpperCase() || "N/A"}`,
        `League: ${selectedMatch["Sport Name"] || "N/A"}`,
        `Home Team: ${selectedMatch["Home Team"] || "N/A"}`,
        `Away Team: ${selectedMatch["Away Team"] || "N/A"}`,
        `Game Time: ${formattedTime}`,
        "",
        "═══════════════════════",
        "######## THANK YOU FOR TRUSTING OGCB",
        "═══════════════════════",
        "",
        `Title: ${titleToUse}`,
        `Pick ID: ${pickId}`,
        `Pick by: ${capperName}`,
        `Input Value: ${allInputsRaw}`,
        `Notes: ${notes}`,
        "",
        "═══════════════════════",
        "######## STRICT CONFIDENTIALITY NOTICE",
        "═══════════════════════",
        "All OG Capper Bets Content is PRIVATE. Leaking, Stealing or Sharing ANY Content is STRICTLY PROHIBITED.",
        "Violation = Termination. No Refund. No Appeal. Lifetime Ban.",
        "",
        `Created: ${estString}`
      ].join("\n");

      const box = document.getElementById("confirmOutput");
      box.classList.remove("hidden");
      box.innerHTML = "";

      const cleanedOutput = output.replace(/[\u2028\u2029]/g, '');
      window._cleanedOutput = cleanedOutput;

      const encodedOutput = encodeURIComponent(cleanedOutput);

      const existingFrame = document.getElementById("slipFrame");
      if (existingFrame) existingFrame.remove();

      // Create both iframes
      const createIframe = (slideNum, visible) => {
        const iframe = document.createElement("iframe");
        iframe.className = "slipFrame";
        iframe.dataset.slide = slideNum;
        iframe.style.display = visible ? "block" : "none";
        iframe.src = `${BASE_URL}?json=${encodeURIComponent(JSON.stringify({
          ...{
            "FULL_TEAM_ENTERED": matchedTeam,
            "FULL_BET_TYPE": wager,
            "FULL_WAGER_OUTPUT": `${unitInput} Unit(s)`,
            "PICK_DESC": pickDescValue,
            "NOTES": notes,
            "FULL_LEAGUE_NAME": selectedMatch["Sport Name"],
            "FULL_SPORT_NAME": selectedMatch["League (Group)"],
            "HOME_TEAM_FULL_NAME": selectedMatch["Home Team"],
            "AWAY_TEAM_FULL_NAME": selectedMatch["Away Team"],
            "DATE and TIME OF GAME START": formattedTime,
            "TITLE": titleToUse,
            "PICKID": pickId,
            "CAPPERS NAME": capperName,
            "USER_INPUT_VALUE": allInputsRaw,
            "24HR_LONG_DATE_SECONDS": estString
          }
        }))}&slideNum=${slideNum}`;
        iframe.style.width = "100%";
        iframe.style.maxWidth = "400px";
        iframe.style.border = "none";
        iframe.style.height = "600px";
        iframe.style.zIndex = "1";
        return iframe;
      };

      const iframe1 = createIframe("1", true);
      const iframe2 = createIframe("2", false);

      box.appendChild(iframe1);
      box.appendChild(iframe2);

      // Add toggle button
      if (!document.getElementById("toggleImageBtn")) {
        const toggleBtn = document.createElement("button");
        toggleBtn.textContent = "Switch to Paid Image";
        toggleBtn.id = "toggleImageBtn";
        toggleBtn.style.marginTop = "10px";
        toggleBtn.style.width = "100%";
        toggleBtn.style.maxWidth = "400px";
        toggleBtn.style.boxSizing = "border-box";
        toggleBtn.style.padding = "12px";
        toggleBtn.style.fontSize = "16px";
        toggleBtn.style.backgroundColor = "#2a9fd6";
        toggleBtn.style.color = "white";
        toggleBtn.style.border = "none";
        toggleBtn.style.borderRadius = "6px";
        toggleBtn.style.cursor = "pointer";

        toggleBtn.onclick = () => {
          const frames = document.querySelectorAll(".slipFrame");
          frames.forEach(frame => {
            const isVisible = frame.style.display !== "none";
            frame.style.display = isVisible ? "none" : "block";
          });

          const showingSlide2 = iframe2.style.display === "block";
          toggleBtn.textContent = showingSlide2 ? "Switch to Regular Image" : "Switch to Paid Image";
        };

        box.parentNode.insertBefore(toggleBtn, box);
      }
      setTimeout(() => {
        box.style.overflow = "hidden";
        box.style.height = box.scrollHeight + "px";
      }, 0);
    };

  </script>

</body>
</html>
